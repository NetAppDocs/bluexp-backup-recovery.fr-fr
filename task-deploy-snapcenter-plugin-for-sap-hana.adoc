---
sidebar: sidebar 
permalink: task-deploy-snapcenter-plugin-for-sap-hana.html 
keywords: Cloud Manager, BlueXP, SnapCenter Plug-in for SAP HANA, SAP HANA, database, host, deploy 
summary: Déployez le plug-in SnapCenter pour SAP HNAN sur chacun des hôtes de base de données SAP HANA. 
---
= Déployez le plug-in SnapCenter pour SAP HANA et ajoutez des hôtes de base de données
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
Vous devez déployer le plug-in SnapCenter pour SAP HANA sur chacun des hôtes de base de données SAP HANA. Selon que l'authentification basée sur une clé SSH est activée ou non sur l'hôte SAP HANA, vous pouvez suivre l'une des méthodes de déploiement du plug-in.



== Prérequis

* Assurez-vous que Java 11 (64 bits) Oracle Java ou OpenJDK est installé sur chacun des hôtes de base de données SAP HANA.
* Vous devez avoir ajouté l'environnement de travail et créé le connecteur.
* Assurez-vous que le connecteur est connecté à l'environnement de travail
* Assurez-vous que l'utilisateur BlueXP a le rôle "Admin compte".
* Vous devez avoir créé l'utilisateur SnapCenter et configuré sudo pour l'utilisateur SnapCenter. Pour plus d'informations, reportez-vous à la section link:task-deploy-snapcenter-plugin-for-sap-hana.html#configure-sudo-for-snapcenter-user["Configurez sudo pour l'utilisateur SnapCenter."]
* Vous devez avoir déployé le plug-in SnapCenter pour SAP HANA avant d'ajouter l'hôte de base de données.
* Lors de l'ajout des hôtes de base de données SAP HANA, vous devez ajouter les clés de stockage HDB. La clé de stockage sécurisée HDB est utilisée pour stocker les informations de connexion des hôtes de base de données SAP HANA en toute sécurité sur le client et le client HDBSQL utilise la clé de stockage utilisateur sécurisée pour se connecter à l'hôte de base de données SAP HANA.
* Pour la réplication système HANA (HSR), pour protéger les systèmes HANA, vous devez enregistrer manuellement les systèmes HANA primaires et secondaires.
* La communication doit être activée sur le port SSH (par défaut : 22) si un déploiement SSH est utilisé.
* La communication du connecteur doit être activée sur le port plug-in (par défaut : 8145) pour que les opérations fonctionnent.




== Configurez sudo pour l'utilisateur SnapCenter

Vous devez créer un utilisateur SnapCenter pour déployer le plug-in.

*Étapes*

. Connectez-vous à la machine virtuelle du connecteur.
. Téléchargez le binaire du plug-in hôte Linux.
`sudo docker exec -it cloudmanager_scs_cloud curl -X GET 'http://127.0.0.1/deploy/downloadLinuxPlugin'`
. Obtenez le chemin de montage de base.
`sudo docker volume ls | grep scs_cloud_volume | awk {'print $2'} | xargs sudo docker volume inspect | grep Mountpoint`
. Copier les lignes 1 à 16 à partir du `oracle_checksum_scs.txt` dossier situé à `base_mount_path/version/sc-linux-host-plugin/`
. Connectez-vous à l'hôte de la base de données SAP HANA et effectuez les opérations suivantes :
+
.. Créez le compte utilisateur SnapCenter, la paire de clés privées et attribuez les autorisations.
.. Collez les lignes que vous avez copiées à l'étape 4 dans le `/etc/sudoers` Fichier à l'aide de l'utilitaire Linux de visualisation.
+
Dans les lignes ci-dessus, remplacez le <LINUXUSER> par l'utilisateur SnapCenter que vous avez créé et enregistrez dans l'utilitaire de visualisation.







== Déployez le plug-in avec l'authentification basée sur des clés SSH

Si l'authentification basée sur la clé SSH est activée sur l'hôte HANA, vous pouvez effectuer les étapes suivantes pour déployer le plug-in. Avant d'effectuer les étapes, assurez-vous que la connexion SSH au connecteur est activée.

*Étapes*

. Connectez-vous à la machine virtuelle du connecteur.
. Obtenez le chemin de montage de base.
`# sudo docker volume ls | grep scs_cloud_volume | awk {'print $2'} | xargs sudo docker volume inspect | grep Mountpoint`
. Déployez le plug-in.
`# sudo <base_mount_path>/scripts/hana_plugin_copy_and_install.sh --host <host_name> --sshkey <ssh_key_file> --username <user_name> --port <ssh_port> --pluginport <plugin_port> --installdir <install_dir>`
+
** Host_name est le nom de l'hôte HANA, et il s'agit d'un paramètre obligatoire.
** ssh_key_file est la clé SSH utilisée pour la connexion à l'hôte HANA, et il s'agit d'un paramètre obligatoire.
** Nom_utilisateur : utilisateur avec privilèges SSH sur l'hôte HANA, et il s'agit d'un paramètre facultatif. La valeur par défaut est azureuser.
** ssh_port : port SSH sur l'hôte HANA, et ce paramètre est facultatif. La valeur par défaut est 22.
** Plugin_port : port utilisé par le plug-in, et il s'agit d'un paramètre facultatif. La valeur par défaut est 8145.
** Dossier_installation : répertoire dans lequel le plug-in sera déployé, et il s'agit d'un paramètre facultatif. La valeur par défaut est /opt.




Après avoir déployé le plug-in, vous devez ajouter le link:task-deploy-snapcenter-plugin-for-sap-hana.html#add-sap-hana-database-hosts["Hôtes de base de données SAP HANA."]



== Déployez le plug-in manuellement

Si l'authentification basée sur la clé SSH n'est pas activée sur l'hôte HANA, vous devez effectuer les étapes manuelles suivantes pour déployer le plug-in.

*Étapes*

. Connectez-vous à la machine virtuelle du connecteur.
. Téléchargez le binaire du plug-in hôte Linux.
`# sudo docker exec -it cloudmanager_scs_cloud curl -X GET 'http://127.0.0.1/deploy/downloadLinuxPlugin'`
. Obtenez le chemin de montage de base.
`sudo docker volume ls | grep scs_cloud_volume | awk {'print $2'} | xargs sudo docker volume inspect | grep Mountpoint`
. Obtenez le chemin binaire du plug-in téléchargé.
`sudo ls <base_mount_path> $(sudo docker ps|grep -Po "cloudmanager_scs_cloud:.*? "|sed -e 's/ *$//'|cut -f2 -d":")/sc-linux-host-plugin/snapcenter_linux_host_plugin_scs.bin`
. Copier `snapcenter_linux_host_plugin_scs.bin` Vers chacun des hôtes de la base de données SAP HANA à l'aide de scp ou d'autres méthodes alternatives.
. Sur l'hôte de la base de données SAP HANA, exécutez la commande suivante pour activer les autorisations d'exécution pour le binaire.
`chmod +x snapcenter_linux_host_plugin_scs.bin`
. Déployez le plug-in SAP HANA en tant qu'utilisateur sudo SnapCenter.
`./snapcenter_linux_host_plugin_scs.bin -i silent -DSPL_USER=<non-root-user>`
. Copier `certificate.p12` de `<base_mount_path>/client/certificate/` Chemin d'accès de la machine virtuelle connecteur à `/var/opt/snapcenter/spl/etc/` sur l'hôte du plug-in.
+
.. Accédez à `/var/opt/snapcenter/spl/etc` et exécutez la commande keytool pour importer le certificat.
`keytool -v -importkeystore -srckeystore certificate.p12 -srcstoretype PKCS12 -destkeystore keystore.jks -deststoretype JKS -srcstorepass snapcenter -deststorepass snapcenter -srcalias agentcert -destalias agentcert -noprompt`
.. Redémarrer SPL : `systemctl restart spl`


. Vérifier que le plug-in est accessible depuis le connecteur en exécutant la commande ci-dessous à partir du connecteur :
+
`docker exec -it cloudmanager_scs_cloud curl -ik \https://<FQDN or IP of the plug-in host>:<plug-in port>/getVersion --cert /config/client/certificate/certificate.pem --key /config/client/certificate/key.pem`





== Ajouter des hôtes de base de données SAP HANA

Vous devez ajouter manuellement des hôtes de base de données SAP HANA pour attribuer des règles et créer des sauvegardes. La découverte automatique de l'hôte de base de données SAP HANA n'est pas prise en charge.

*Étapes*

. Dans l'interface utilisateur *BlueXP*, cliquez sur *protection* > *sauvegarde et restauration* > *applications*.
. Cliquez sur *découvrir les applications*.
. Sélectionnez *Cloud Native* > *SAP HANA* et cliquez sur *Next*.
. Dans la page *applications*, cliquez sur *Ajouter système*.
. Dans la page *Détails du système*, effectuez les opérations suivantes :
+
.. Sélectionnez le Type de système comme conteneur de base de données mutualisé ou conteneur unique.
.. Entrez le nom du système SAP HANA.
.. Spécifier le SID du système SAP HANA.
.. (Facultatif) spécifiez l'utilisateur HDBSQL OS.
.. Sélectionnez Plug-in host. (Facultatif) si l'hôte n'est pas ajouté ou si vous souhaitez ajouter plusieurs hôtes, cliquez sur *Ajouter hôte de plug-in*.
.. Si le système HANA est configuré avec la réplication système HANA, activez *HANA System Replication (HSR) System*.
.. Cliquez sur *HDB Secure User Store Keys* (clés de stockage d'utilisateur sécurisées) pour ajouter les détails des clés de la boutique d'utilisateurs.
+
Spécifiez le nom de la clé, les détails du système, le nom d'utilisateur et le mot de passe, puis cliquez sur *Ajouter une clé*.

+
Vous pouvez supprimer ou modifier les clés de la boutique utilisateur.



. Cliquez sur *Suivant*.
. Dans la page *empreinte de stockage*, cliquez sur *Ajouter un stockage* et effectuez les opérations suivantes :
+
.. Sélectionnez l'environnement de travail et spécifiez le compte NetApp.
+
Accédez à la page *Canvas* pour ajouter un nouvel environnement de travail

.. Sélectionnez les volumes requis.
.. Cliquez sur *Ajouter un stockage*.


. Vérifiez tous les détails et cliquez sur *Ajouter système*.



NOTE: Le filtre permettant d'afficher un hôte spécifique ne fonctionne pas. Lorsque vous spécifiez un nom d'hôte dans le filtre, tous les hôtes sont affichés

Vous pouvez modifier et supprimer les systèmes SAP HANA à l'aide de l'API REST. Avant de supprimer le système HANA, vous devez supprimer toutes les sauvegardes associées et supprimer la protection.



=== Ajouter des volumes non-données

Après avoir ajouté le conteneur de base de données mutualisé ou un système SAP HANA de type conteneur unique, vous pouvez ajouter les volumes non-Data du système HANA.

*Étapes*

. Dans l'interface utilisateur *BlueXP*, cliquez sur *protection* > *sauvegarde et restauration* > *applications*.
. Cliquez sur *découvrir les applications*.
. Sélectionnez *Cloud Native* > *SAP HANA* et cliquez sur *Next*.
. Dans la page *applications*, cliquez sur image:icon-action.png["pour sélectionner l'action"] Correspondant au système pour lequel vous souhaitez ajouter les volumes non-données et sélectionner *gérer le système* > *non-Data Volume*.




=== Ajouter des volumes globaux non-données

Après avoir ajouté le conteneur de base de données mutualisée ou un seul type de conteneur SAP HANA, vous pouvez ajouter le système non-Data volumes global du système HANA.

*Étapes*

. Dans l'interface utilisateur *BlueXP*, cliquez sur *protection* > *sauvegarde et restauration* > *applications*.
. Cliquez sur *découvrir les applications*.
. Sélectionnez *Cloud Native* > *SAP HANA* et cliquez sur *Next*.
. Dans la page *applications*, cliquez sur *Ajouter système*.
. Dans la page *Détails du système*, effectuez les opérations suivantes :
+
.. Dans la liste déroulante Type de système, sélectionnez *Volume global hors données*.
.. Entrez le nom du système SAP HANA.
.. Spécifiez les SID associés du système SAP HANA.
.. Sélectionnez l'hôte du plug-in
+
(Facultatif) pour ajouter plusieurs hôtes, cliquez sur *Ajouter hôte du plug-in* et spécifiez le nom d'hôte et le port, puis cliquez sur *Ajouter hôte*.

.. Cliquez sur *Suivant*.
.. Vérifiez tous les détails et cliquez sur *Ajouter système*.



